#! /usr/local/bin/perl

package user;

use strict;
use warnings;
#use CGI;

#warn "sr7: in perl/common/user\n";

use EnsEMBL::Web::Controller;

{

my $controller = EnsEMBL::Web::Controller->new;

## Login basics
$controller->add_connection({ 'Login' => 'EnsEMBL::Web::Controller::Command::User::LogIn' });
$controller->add_connection({ '_set_cookie' => 'EnsEMBL::Web::Controller::Command::User::SetCookie' });
$controller->add_connection({ 'LoggedIn' => 'EnsEMBL::Web::Controller::Command::User::LoggedIn' });
$controller->add_connection({ '_logout' => 'EnsEMBL::Web::Controller::Command::User::LogOut' });

## Account management 
$controller->add_connection({ 'Register' => 'EnsEMBL::Web::Controller::Command::User::Register' }); 
$controller->add_connection({ '_send_activation' => 'EnsEMBL::Web::Controller::Command::User::SendActivation' }); 
$controller->add_connection({ '_email_sent' => 'EnsEMBL::Web::Controller::Command::User::EmailSent' }); 
$controller->add_connection({ 'Activate' => 'EnsEMBL::Web::Controller::Command::User::EnterPassword' }); 
$controller->add_connection({ 'Account' => 'EnsEMBL::Web::Controller::Command::User::Account' }); 
$controller->add_connection({ 'LostPassword' => 'EnsEMBL::Web::Controller::Command::User::LostPassword' }); 
$controller->add_connection({ 'Password' => 'EnsEMBL::Web::Controller::Command::User::EnterPassword' }); 
$controller->add_connection({ '_save_password' => 'EnsEMBL::Web::Controller::Command::User::SavePassword' }); 
$controller->add_connection({ 'Update' => 'EnsEMBL::Web::Controller::Command::User::UpdateAccount' }); 
$controller->add_connection({ 'UpdateFailed' => 'EnsEMBL::Web::Controller::Command::User::UpdateFailed'}); 

## User records
$controller->add_connection({ 'SaveFavourites' => 'EnsEMBL::Web::Controller::Command::User::SaveFavourites' }); 
$controller->add_connection({ 'ResetFavourites' => 'EnsEMBL::Web::Controller::Command::User::ResetFavourites' }); 
$controller->add_connection({ '_sortable' => 'EnsEMBL::Web::Controller::Command::User::Sortable' }); 
$controller->add_connection({ '_hide_info' => 'EnsEMBL::Web::Controller::Command::User::HideInfo' }); 
$controller->add_connection({ '_reset_info_boxes' => 'EnsEMBL::Web::Controller::Command::User::ResetInfoBoxes' }); 

$controller->add_connection({ 'Bookmark' => 'EnsEMBL::Web::Controller::Command::User::Bookmark' }); 
$controller->add_connection({ '_bookmark_landing' => 'EnsEMBL::Web::Controller::Command::User::BookmarkLanding'});
$controller->add_connection({ '_use_bookmark' => 'EnsEMBL::Web::Controller::Command::User::UseBookmark'});

$controller->add_connection({ 'Configuration' => 'EnsEMBL::Web::Controller::Command::User::Configuration' }); 
$controller->add_connection({ '_load_config' => 'EnsEMBL::Web::Controller::Command::User::LoadConfig' }); 
$controller->add_connection({ '_set_config' => 'EnsEMBL::Web::Controller::Command::User::SetConfig' }); 
$controller->add_connection({ '_config_landing' => 'EnsEMBL::Web::Controller::Command::User::ConfigLanding'});

$controller->add_connection({ 'Annotation' => 'EnsEMBL::Web::Controller::Command::User::Annotation' }); 
$controller->add_connection({ 'News' => 'EnsEMBL::Web::Controller::Command::User::FilterNews' }); 

## Group records & group management
$controller->add_connection({ 'ManageGroup' => 'EnsEMBL::Web::Controller::Command::User::Group' }); 
$controller->add_connection({ 'Group' => 'EnsEMBL::Web::Controller::Command::User::ViewGroup' }); 
$controller->add_connection({ '_remove_group' => 'EnsEMBL::Web::Controller::Command::User::RemoveGroup' }); 
$controller->add_connection({ '_change_status' => 'EnsEMBL::Web::Controller::Command::User::ChangeStatus' }); 
$controller->add_connection({ '_change_level' => 'EnsEMBL::Web::Controller::Command::User::ChangeLevel' }); 

$controller->add_connection({ 'SelectGroup' => 'EnsEMBL::Web::Controller::Command::User::SelectGroup' }); 
$controller->add_connection({ '_share_record' => 'EnsEMBL::Web::Controller::Command::User::ShareRecord' }); 

$controller->add_connection({ 'Invite' => 'EnsEMBL::Web::Controller::Command::User::Invite' }); 
$controller->add_connection({ '_remove_invitation' => 'EnsEMBL::Web::Controller::Command::User::RemoveInvitation' }); 
$controller->add_connection({ '_accept' => 'EnsEMBL::Web::Controller::Command::User::AcceptInvitation' }); 
$controller->add_connection({ '_unsubscribe' => 'EnsEMBL::Web::Controller::Command::User::Unsubscribe' }); 

#warn "sr7: in perl/common/user, just before dispatch to : $ENV{REQUEST_URI} \n";
#if($ENV{REQUEST_URI} =~ /common\/user\/register\?dataview=success;user_id=/){
  #redirect to vega home
#  CGI::redirect('/user_register_message.html');

#}
#else{

 # warn "failed to capture $ENV{REQUEST_URI} \n";

$controller->dispatch($ENV{REQUEST_URI});
#}


}

1;
