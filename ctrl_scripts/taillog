#!/usr/local/bin/perl

=head1 NAME

taillog - script to tail -f the current log

=head1 SYNOPSIS

    ctrl_scripts/taillog [--access] [--host=hostname]

=head1 DESCRIPTION

This script starts a "tail -f" on the current apache log.
By default, it tails the latest error log for the current host, but
specifying --access tails the access log instead, and --host=hostname 
changes the host

=head1 LICENCE

This code is distributed under an Apache style licence:
Please see http://www.ensembl.org/code_licence.html for details

=head1 AUTHOR

Jim Stalker <jws@sanger.ac.uk>

=cut

use strict;
use warnings;
no warnings 'uninitialized';

use Getopt::Long;
use FindBin qw($Bin);
use File::Basename qw( dirname );
use Sys::Hostname::Long;

my $serverroot;

BEGIN {
  $serverroot = dirname($Bin);
  unshift @INC, "$serverroot/conf";
};

use SiteDefs;


my ($help, $do_access);
&GetOptions(
  "access"  => \$do_access,
  "h"       => \$help,
);
die '
------------------------------------------------------------------------
Usage:
  ctrl_scripts/taillog
    [-a|--access]
    [-h|--help]
        
Options:
  -a, --access    : Tails access log instead of error log
  -h, --help      : print this help message
	
------------------------------------------------------------------------
' if $help;

(my $logname = $do_access ? $SiteDefs::ENSEMBL_CUSTOMLOG : $SiteDefs::ENSEMBL_ERRORLOG) =~ s/\s.*//;

my $cmd = "tail -f $logname";
exec($cmd) or die "Could not tail log: $!.\n";

