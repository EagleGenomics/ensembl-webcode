<pre><font face="Lucida,Courier New"><font color="#008000">#!/usr/bin/env jython
</font>
<font color="#000000">__version__</font> <font color="#0000C0">=</font> <font color="#004080">"$Revision$"</font>

<font color="#004080">"""
enspeptidize.py -- get peptide accession IDs of longest translatoin

ensdescribe.py COL... &lt; inputfile

Each COL is a column in the tab-delimited input file that contains an
Ensembl accession ID.

Example:

$ echo ENSG00000139618 | enspeptidize.py 1 2&gt; /dev/null
ENSG00000139618 ENSP00000267071
"""</font>

<font color="#C00000">import</font> <font color="#000000">re</font>
<font color="#C00000">import</font> <font color="#000000">sys</font>
<font color="#C00000">from</font> <font color="#000000">xreadlines</font> <font color="#C00000">import</font> <font color="#000000">xreadlines</font>

<font color="#C00000">import</font> <font color="#000000">ensembl</font>

<font color="#C00000">def</font> <font color="#000000">enumerate_list</font><font color="#0000C0">(</font><font color="#000000">seq</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#004080">"""
    enumerate_list(["a", "b", "c"]) -&gt; [(0, "a"), (1, "b"), (2, "c")]
    """</font>
    <font color="#C00000">return</font> <font color="#000000">zip</font><font color="#0000C0">(</font><font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#000000">len</font><font color="#0000C0">(</font><font color="#000000">seq</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">,</font> <font color="#000000">seq</font><font color="#0000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">main</font><font color="#0000C0">(</font><font color="#000000">args</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#000000">marked_column_indexes</font> <font color="#0000C0">=</font> <font color="#0000C0">[</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">arg</font><font color="#0000C0">)</font><font color="#0000C0">-</font><font color="#0080C0">1</font> <font color="#C00000">for</font> <font color="#000000">arg</font> <font color="#C00000">in</font> <font color="#000000">args</font><font color="#0000C0">]</font>

    <font color="#C00000">for</font> <font color="#000000">line</font> <font color="#C00000">in</font> <font color="#000000">xreadlines</font><font color="#0000C0">(</font><font color="#000000">sys</font><font color="#0000C0">.</font><font color="#000000">stdin</font><font color="#0000C0">)</font><font color="#0000C0">:</font> <font color="#008000"># this is the same as python 2.2 "for line in sys.stdin:"</font>
        <font color="#000000">cols</font> <font color="#0000C0">=</font> <font color="#000000">line</font><font color="#0000C0">.</font><font color="#000000">rstrip</font><font color="#0000C0">(</font><font color="#0000C0">)</font><font color="#0000C0">.</font><font color="#000000">split</font><font color="#0000C0">(</font><font color="#004080">"\t"</font><font color="#0000C0">)</font>
        <font color="#C00000">for</font> <font color="#000000">col_index</font><font color="#0000C0">,</font> <font color="#000000">col</font> <font color="#C00000">in</font> <font color="#000000">enumerate_list</font><font color="#0000C0">(</font><font color="#000000">cols</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">col_index</font> <font color="#C00000">in</font> <font color="#000000">marked_column_indexes</font><font color="#0000C0">:</font>
                <font color="#C00000">print</font> <font color="#0000C0">&gt;&gt;</font><font color="#000000">sys</font><font color="#0000C0">.</font><font color="#000000">stderr</font><font color="#0000C0">,</font> <font color="#000000">col</font>

                <font color="#000000">gene</font> <font color="#0000C0">=</font> <font color="#000000">ensembl</font><font color="#0000C0">.</font><font color="#000000">fetch</font><font color="#0000C0">(</font><font color="#000000">col</font><font color="#0000C0">)</font>
                <font color="#000000">longest_transcript</font> <font color="#0000C0">=</font> <font color="#000000">max</font><font color="#0000C0">(</font><font color="#0000C0">[</font><font color="#0000C0">(</font><font color="#000000">transcript</font><font color="#0000C0">.</font><font color="#000000">length</font><font color="#0000C0">,</font> <font color="#000000">transcript</font><font color="#0000C0">)</font> <font color="#C00000">for</font> <font color="#000000">transcript</font> <font color="#C00000">in</font> <font color="#000000">gene</font><font color="#0000C0">.</font><font color="#000000">transcripts</font><font color="#0000C0">]</font><font color="#0000C0">)</font><font color="#0000C0">[</font><font color="#0080C0">1</font><font color="#0000C0">]</font>
                <font color="#000000">peptide_ensid</font> <font color="#0000C0">=</font> <font color="#000000">longest_transcript</font><font color="#0000C0">.</font><font color="#000000">translation</font><font color="#0000C0">.</font><font color="#000000">accessionID</font>
                <font color="#000000">cols</font><font color="#0000C0">[</font><font color="#000000">col_index</font><font color="#0000C0">]</font> <font color="#0000C0">=</font> <font color="#004080">"\t"</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#0000C0">[</font><font color="#000000">col</font><font color="#0000C0">,</font> <font color="#000000">peptide_ensid</font><font color="#0000C0">]</font><font color="#0000C0">)</font>

        <font color="#C00000">print</font> <font color="#004080">"\t"</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#000000">cols</font><font color="#0000C0">)</font>

<font color="#C00000">if</font> <font color="#000000">__name__</font> <font color="#0000C0">==</font> <font color="#004080">"__main__"</font><font color="#0000C0">:</font>
    <font color="#000000">sys</font><font color="#0000C0">.</font><font color="#000000">exit</font><font color="#0000C0">(</font><font color="#000000">main</font><font color="#0000C0">(</font><font color="#000000">sys</font><font color="#0000C0">.</font><font color="#000000">argv</font><font color="#0000C0">[</font><font color="#0080C0">1</font><font color="#0000C0">:</font><font color="#0000C0">]</font><font color="#0000C0">)</font><font color="#0000C0">)</font> <font color="#008000"># system return status = main(arguments without the name of the script)</font><font color="#000000"></font></font></pre>